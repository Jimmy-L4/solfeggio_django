(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-268a1d30"],{"0fea":function(t,e,n){"use strict";n.d(e,"k",(function(){return r})),n.d(e,"l",(function(){return s})),n.d(e,"p",(function(){return a})),n.d(e,"o",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return l})),n.d(e,"q",(function(){return p})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return m})),n.d(e,"h",(function(){return g})),n.d(e,"n",(function(){return b})),n.d(e,"m",(function(){return v})),n.d(e,"d",(function(){return _})),n.d(e,"g",(function(){return y})),n.d(e,"j",(function(){return w})),n.d(e,"s",(function(){return q})),n.d(e,"w",(function(){return L})),n.d(e,"t",(function(){return j})),n.d(e,"r",(function(){return D})),n.d(e,"u",(function(){return S})),n.d(e,"v",(function(){return O}));var o=n("b775"),i={user:"/user",role:"/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree",studentList:"/manage/studentList",commitList:"/manage/commitList",noticeList:"/notice/",ChoiceQuesList:"/question/choice/",DictationQuesList:"/question/dictation/",SightsingingQuesList:"/question/sightsinging/",SightsingingList:"/question/sightsinging_list/",ChoiceList:"/question/choice_list/",DictationList:"/question/dictation_list/",QuesGroupList:"/homework/quse_group/",ChoiceRecord:"/homework/choice/",SightsingingRecord:"/homework/sightsinging/",DictationRecord:"/homework/dictation/",UploadAudio:"/router/audio/",UploadJson:"/router/json/",UploadPNG:"/router/png/",studentInfo:"/user/student_info/",changePass:"/user/change_pass/"};function r(t){return Object(o["b"])({url:i.role,method:"get",params:t})}function s(t){return Object(o["b"])({url:i.service,method:"get",params:t})}function a(t){return Object(o["b"])({url:i.studentList,method:"get",params:t})}function u(t){return Object(o["b"])({url:i.studentInfo,method:"get",params:t})}function c(t){return Object(o["b"])({url:i.changePass,method:"post",data:t})}function d(t){return Object(o["b"])({url:i.commitList,method:"get",params:t})}function l(t){return Object(o["b"])({url:i.noticeList,method:"get",params:t})}function p(t){return Object(o["b"])({url:i.noticeList,method:"put",data:t})}function h(t){return Object(o["b"])({url:i.noticeList,method:"post",data:t})}function f(t){return Object(o["b"])({url:i.noticeList,method:"delete",data:t})}function m(t){return Object(o["b"])({url:i.ChoiceQuesList,method:"get",params:t})}function g(t){return Object(o["b"])({url:i.DictationQuesList,method:"get",params:t})}function b(t){return Object(o["b"])({url:i.SightsingingQuesList,method:"get",params:t})}function v(t){return Object(o["b"])({url:i.SightsingingList,method:"get",params:t})}function _(t){return Object(o["b"])({url:i.ChoiceList,method:"get",params:t})}function y(t){return Object(o["b"])({url:i.DictationList,method:"get",params:t})}function w(t){return Object(o["b"])({url:i.QuesGroupList,method:"get",params:t})}function q(t){return Object(o["b"])({url:i.ChoiceRecord,method:"post",data:t})}function L(t){return Object(o["b"])({url:i.SightsingingRecord,method:"post",data:t})}function j(t){return Object(o["b"])({url:i.DictationRecord,method:"post",data:t})}function D(t){return Object(o["b"])({url:i.UploadAudio,method:"post",data:t})}function S(t){return Object(o["b"])({url:i.UploadJson,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function O(t){return Object(o["b"])({url:i.UploadPNG,method:"post",data:t})}},1711:function(t,e,n){"use strict";n("53db")},"53db":function(t,e,n){},d813:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("page-header-wrapper",{attrs:{title:"视唱题目页面",content:"请根据要求录制对应曲目"}},[n("a-card",{attrs:{"body-style":{padding:"24px 32px"},bordered:!1}},[n("a-card",{attrs:{bordered:!1,title:!1}},[n("a-descriptions",{attrs:{title:"基础信息"}},[n("a-descriptions-item",{attrs:{label:"歌曲名称"}},[t._v(t._s(t.quesDetail.audio_detail.audio_name))]),n("a-descriptions-item",{attrs:{label:"演奏者"}},[t._v(t._s(t.quesDetail.audio_detail.audio_player))]),n("a-descriptions-item"),n("a-descriptions-item",{attrs:{label:"乐器"}},[t._v(t._s(t.quesDetail.audio_detail.audio_instrument))]),n("a-descriptions-item",{attrs:{label:"名族"}},[t._v(t._s(t.quesDetail.audio_detail.audio_nation))]),n("a-descriptions-item"),0!=t.quesType?n("a-descriptions-item",{attrs:{label:"低声部"}},[t._v(t._s(t.lowPart))]):t._e(),0!=t.quesType?n("a-descriptions-item",{attrs:{label:"高声部"}},[t._v(t._s(t.highPart))]):t._e()],1),n("div",{staticStyle:{"font-size":"14px",color:"rgba(0, 0, 0, 0.85)","margin-bottom":"16px","font-weight":"500"}},[n("div",[t._v("范例音:"),n("audio-player",{staticStyle:{"margin-top":"12px"},attrs:{src:t.quesDetail.audio_path}})],1),n("div",{staticStyle:{"margin-top":"16px"}},[t._v("节拍器:"),n("audio-player",{staticStyle:{"margin-top":"12px"},attrs:{src:t.metroSrc}})],1)]),n("a-card",{staticStyle:{"margin-top":"24px"},attrs:{type:"inner",title:"曲谱信息"}},[n("img",{attrs:{width:800,src:t.quesDetail.pic_path}})]),n("a-card",[n("div",{staticStyle:{"min-height":"250px"}},[n("my-recorder",{ref:"content",class:t.dragToggle?"staticRecorder":"fiedRecorder",attrs:{attempts:5,time:5,"start-record":t.startRecord,"stop-record":t.stopRecord,getRecord:t.getRecord,dragToggle:t.toggle}})],1)])],1)],1),n("footer-tool-bar",[n("a-button",{attrs:{type:"default"},on:{click:t.downloadAudio}},[t._v("下载音频")]),t.statusMap[t.quesDetail.state].disabled?n("a-tooltip",{attrs:{placement:"topRight"},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",[t._v(t._s(t.statusMap[t.quesDetail.state].text))])]},proxy:!0}],null,!1,2122956748)},[n("a-button",{staticStyle:{"margin-left":"20px"},attrs:{disabled:!0,type:"primary",loading:t.loading}},[t._v("提交")])],1):n("a-popconfirm",{attrs:{title:"确认提交作业吗？提交后将无法修改！"},on:{confirm:t.startUpload}},[n("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",loading:t.loading}},[t._v("提交")])],1)],1)],1)},i=[],r=(n("b0c0"),n("d3b7"),n("25f0"),n("ac1f"),n("5319"),n("56cd")),s=n("5a70"),a=n("0fea"),u={0:{disabled:!1,text:"待完成"},1:{disabled:!0,text:"作业已完成，无法再次提交！"},2:{disabled:!0,text:"作业已逾期，无法再进行提交！"}},c={name:"SightsingLayout",components:{FooterToolBar:s["a"]},data:function(){return{global_url:"https://musicmuc.chimusic.net/solfeggio/",loading:!1,dragToggle:!0,token:this.$store.getters.token,userInfo:this.$store.getters.userInfo,quesDetail:{},record:{},coopStudentInfo:{},voicePart:"",statusMap:u}},computed:{headers:function(){return{Authorization:"Bearer "+this.token}},metroSrc:function(){return"/library/metronome/"+this.quesDetail.note+"_"+this.quesDetail.beat+"_"+this.quesDetail.bpm+".mp3"},quesType:function(){var t={"":0,"低声部":1,"高声部":2};return t[this.voicePart]},lowPart:function(){return"1"==this.quesType?this.userInfo.name:this.coopStudentInfo.name},highPart:function(){return"2"==this.quesType?this.userInfo.name:this.coopStudentInfo.name}},beforeMount:function(){this.$route.params.quesDetail?(this.quesDetail=this.$route.params.quesDetail,"coopStudentInfo"in this.$route.params&&(this.coopStudentInfo=this.$route.params.coopStudentInfo,this.voicePart=this.$route.params.voicePart)):this.$router.push({name:"home",replace:!0})},mounted:function(){this.draggable(this.$refs.content.$el)},methods:{startRecord:function(t){r["a"].success({message:"开始录制音频",description:""})},stopRecord:function(t){r["a"].success({message:"结束录制音频",description:""})},getRecord:function(t){this.record=t},startUpload:function(){var t=this;if(this.record.url){this.loading=!0;var e=new FormData;e.append("content",this.record.blob,this.quesDetail.part_id+"-"+this.userInfo.user.toString()+".wav"),e.append("part_id",this.quesDetail.part_id),e.append("user",this.userInfo.user),Object(a["r"])(e).then((function(e){t.submitHomework(e)})).catch((function(e){r["a"].error({message:"音频上传失败"}),t.loading=!1}))}else r["a"].error({message:"请选择音频后再进行上传！"})},submitHomework:function(t){var e=this,n={part_id:this.quesDetail.part_id,audio:t.content.replace("http://127.0.0.1:8000",""),user:this.userInfo.user,quesType:this.quesType};"0"!=this.quesType&&(n["coopStudentInfo"]=this.coopStudentInfo),Object(a["w"])(n).then((function(t){r["a"].success({message:"音频上传成功",description:"在个人中心中查看提交详情！"}),e.loading=!1,e.$router.push({name:"sightsing-list",replace:!0,params:{lesson_No:e.quesDetail.part_id.charAt(18)}})})).catch((function(t){r["a"].error({message:"音频上传失败",description:t.response.data}),e.loading=!1}))},downloadAudio:function(){if(this.record.url){var t=document.createElement("a");t.href=this.record.url,t.download="record.wav",t.click()}else r["a"].error({message:"请选择音频后再进行下载！"})},callback:function(t){},toggle:function(){var t=this.$refs.content.$el;t.style.left="0px",t.style.top="0px",this.dragToggle=!this.dragToggle},draggable:function(t){var e,n,o,i,r,s,a,u,c;function d(e){e.preventDefault(),t.style.cursor="grabbing";var s=e||window.event;t.offsetLeft,t.offsetTop,u=s.touches?s.touches[0].clientX:s.clientX,c=s.touches?s.touches[0].clientY:s.clientY,i=u-t.offsetLeft,r=c-t.offsetTop,document.addEventListener(n,l),document.addEventListener(o,p)}function l(e){var n=e||window.event;s=(n.touches?n.touches[0].clientX:n.clientX)-i,a=(n.touches?n.touches[0].clientY:n.clientY)-r,s<0?s=0:s>document.documentElement.clientWidth-t.offsetWidth&&(s=document.documentElement.clientWidth-t.offsetWidth),a<0?a=0:a>window.innerHeight-t.offsetHeight&&(a=window.innerHeight-t.offsetHeight),t.style.left=s+"px",t.style.top=a+"px"}function p(e){t.style.cursor="",document.removeEventListener(n,l),document.removeEventListener(o,p)}"ontouchstart"in window?(e="touchstart",n="touchmove",o="touchend"):(e="mousedown",n="mousemove",o="mouseup"),t.addEventListener(e,d)}}},d=c,l=(n("1711"),n("2877")),p=Object(l["a"])(d,o,i,!1,null,"9c0e5f2e",null);e["default"]=p.exports}}]);